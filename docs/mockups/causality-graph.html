<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=900, height=600">
    <title>Causality Graph Structure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background: #ffffff;
            padding: 20px;
            min-height: 600px;
        }
        .container {
            max-width: 860px;
            margin: 0 auto;
        }
        .title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 8px;
            color: #333;
        }
        .subtitle {
            font-size: 14px;
            color: #666;
            text-align: center;
            margin-bottom: 30px;
        }

        /* Graph Container */
        .graph {
            position: relative;
            min-height: 400px;
            padding: 20px;
        }

        /* Node Base */
        .node {
            position: absolute;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 10px 14px;
            background: #fff;
            text-align: center;
            font-size: 12px;
            box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
        }
        .node-label {
            font-weight: bold;
            font-size: 10px;
            margin-bottom: 4px;
            text-transform: uppercase;
        }
        .node-content {
            font-size: 11px;
            color: #333;
            max-width: 120px;
        }

        /* Node Types */
        .node-request {
            background: #ffebee;
            border-color: #c62828;
        }
        .node-request .node-label { color: #c62828; }

        .node-analysis {
            background: #e3f2fd;
            border-color: #1976d2;
        }
        .node-analysis .node-label { color: #1976d2; }

        .node-decision {
            background: #e8f5e9;
            border-color: #388e3c;
        }
        .node-decision .node-label { color: #388e3c; }

        .node-file {
            background: #f3e5f5;
            border-color: #7b1fa2;
        }
        .node-file .node-label { color: #7b1fa2; }

        .node-error {
            background: #ffcdd2;
            border-color: #d32f2f;
        }
        .node-error .node-label { color: #d32f2f; }

        .node-solution {
            background: #c8e6c9;
            border-color: #2e7d32;
        }
        .node-solution .node-label { color: #2e7d32; }

        .node-learning {
            background: #fff9c4;
            border-color: #f9a825;
        }
        .node-learning .node-label { color: #f57f17; }

        .node-rejected {
            background: #eeeeee;
            border-color: #757575;
            opacity: 0.7;
        }
        .node-rejected .node-label { color: #616161; }

        /* SVG Lines */
        .lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .edge {
            fill: none;
            stroke: #333;
            stroke-width: 2;
        }
        .edge-causes { stroke: #c62828; }
        .edge-leads-to { stroke: #1976d2; }
        .edge-resolved-by { stroke: #2e7d32; }
        .edge-rejects { stroke: #757575; stroke-dasharray: 5,5; }

        /* Edge Labels */
        .edge-label {
            font-size: 10px;
            fill: #666;
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            justify-content: center;
            margin-top: 20px;
            padding: 16px;
            background: #fafafa;
            border-radius: 8px;
        }
        .legend-section {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .legend-title {
            font-size: 12px;
            font-weight: bold;
            color: #333;
            margin-bottom: 4px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 11px;
        }
        .legend-box {
            width: 14px;
            height: 14px;
            border: 2px solid #333;
            border-radius: 3px;
        }
        .legend-line {
            width: 24px;
            height: 2px;
        }

        /* Importance Badge */
        .badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 9px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
        }
        .badge-high { background: #c62828; }
        .badge-med { background: #f57c00; }
        .badge-low { background: #757575; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">Causality Graph Structure</h1>
        <p class="subtitle">노드 유형 + 엣지 유형 + 중요도 기반 인과관계 추적</p>

        <div class="graph">
            <!-- SVG Lines (drawn first, behind nodes) -->
            <svg class="lines" viewBox="0 0 860 380">
                <!-- REQUEST → ANALYSIS (leads_to) -->
                <path class="edge edge-leads-to" d="M 110 60 L 110 100 L 240 100" marker-end="url(#arrow-blue)"/>
                <text class="edge-label" x="140" y="95">leads_to</text>

                <!-- ANALYSIS → DECISION (leads_to) -->
                <path class="edge edge-leads-to" d="M 320 120 L 320 180 L 400 180" marker-end="url(#arrow-blue)"/>
                <text class="edge-label" x="340" y="175">leads_to</text>

                <!-- DECISION → FILE (causes) -->
                <path class="edge edge-causes" d="M 480 200 L 480 260 L 560 260" marker-end="url(#arrow-red)"/>
                <text class="edge-label" x="500" y="255">causes</text>

                <!-- FILE → ERROR (causes) -->
                <path class="edge edge-causes" d="M 640 280 L 640 320 L 560 320" marker-end="url(#arrow-red)"/>
                <text class="edge-label" x="580" y="315">causes</text>

                <!-- ERROR → SOLUTION (resolved_by) -->
                <path class="edge edge-resolved-by" d="M 480 340 L 400 340" marker-end="url(#arrow-green)"/>
                <text class="edge-label" x="420" y="335">resolved_by</text>

                <!-- SOLUTION → LEARNING (leads_to) -->
                <path class="edge edge-leads-to" d="M 320 340 L 240 340 L 240 300" marker-end="url(#arrow-blue)"/>
                <text class="edge-label" x="260" y="335">leads_to</text>

                <!-- DECISION → REJECTED (rejects) -->
                <path class="edge edge-rejects" d="M 480 160 L 560 140 L 640 140" marker-end="url(#arrow-gray)"/>
                <text class="edge-label" x="560" y="130">rejects</text>

                <!-- Arrow Markers -->
                <defs>
                    <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L9,3 z" fill="#1976d2"/>
                    </marker>
                    <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L9,3 z" fill="#c62828"/>
                    </marker>
                    <marker id="arrow-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L9,3 z" fill="#2e7d32"/>
                    </marker>
                    <marker id="arrow-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L9,3 z" fill="#757575"/>
                    </marker>
                </defs>
            </svg>

            <!-- Nodes -->
            <div class="node node-request" style="left: 40px; top: 30px;">
                <span class="badge badge-high">H</span>
                <div class="node-label">REQUEST</div>
                <div class="node-content">API 인증 기능 구현</div>
            </div>

            <div class="node node-analysis" style="left: 200px; top: 70px;">
                <span class="badge badge-med">M</span>
                <div class="node-label">ANALYSIS</div>
                <div class="node-content">JWT 토큰 방식이 적합함</div>
            </div>

            <div class="node node-decision" style="left: 360px; top: 150px;">
                <span class="badge badge-high">H</span>
                <div class="node-label">DECISION</div>
                <div class="node-content">JWT + Refresh Token 채택</div>
            </div>

            <div class="node node-rejected" style="left: 600px; top: 110px;">
                <span class="badge badge-low">L</span>
                <div class="node-label">REJECTED</div>
                <div class="node-content">Session Cookie 방식</div>
            </div>

            <div class="node node-file" style="left: 520px; top: 230px;">
                <span class="badge badge-med">M</span>
                <div class="node-label">FILE</div>
                <div class="node-content">[CREATE] jwt_handler.py</div>
            </div>

            <div class="node node-error" style="left: 480px; top: 310px;">
                <span class="badge badge-high">H</span>
                <div class="node-label">ERROR</div>
                <div class="node-content">PyJWT import 실패</div>
            </div>

            <div class="node node-solution" style="left: 280px; top: 310px;">
                <span class="badge badge-high">H</span>
                <div class="node-label">SOLUTION</div>
                <div class="node-content">pip install PyJWT</div>
            </div>

            <div class="node node-learning" style="left: 160px; top: 250px;">
                <span class="badge badge-high">H</span>
                <div class="node-label">LEARNING</div>
                <div class="node-content">requirements.txt 추가 필요</div>
            </div>
        </div>

        <!-- Legend -->
        <div class="legend">
            <div class="legend-section">
                <div class="legend-title">노드 유형</div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#ffebee; border-color:#c62828;"></div>
                    <span>REQUEST</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#e3f2fd; border-color:#1976d2;"></div>
                    <span>ANALYSIS</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#e8f5e9; border-color:#388e3c;"></div>
                    <span>DECISION</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#f3e5f5; border-color:#7b1fa2;"></div>
                    <span>FILE</span>
                </div>
            </div>
            <div class="legend-section">
                <div class="legend-title">&nbsp;</div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#ffcdd2; border-color:#d32f2f;"></div>
                    <span>ERROR</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#c8e6c9; border-color:#2e7d32;"></div>
                    <span>SOLUTION</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#fff9c4; border-color:#f9a825;"></div>
                    <span>LEARNING</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background:#eee; border-color:#757575;"></div>
                    <span>REJECTED</span>
                </div>
            </div>
            <div class="legend-section">
                <div class="legend-title">엣지 유형</div>
                <div class="legend-item">
                    <div class="legend-line" style="background:#1976d2;"></div>
                    <span>leads_to</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background:#c62828;"></div>
                    <span>causes</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background:#2e7d32;"></div>
                    <span>resolved_by</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background:#757575; border-style:dashed;"></div>
                    <span>rejects</span>
                </div>
            </div>
            <div class="legend-section">
                <div class="legend-title">중요도</div>
                <div class="legend-item">
                    <span style="background:#c62828; color:#fff; padding:2px 6px; border-radius:4px; font-size:10px;">H</span>
                    <span>HIGH (보존)</span>
                </div>
                <div class="legend-item">
                    <span style="background:#f57c00; color:#fff; padding:2px 6px; border-radius:4px; font-size:10px;">M</span>
                    <span>MEDIUM</span>
                </div>
                <div class="legend-item">
                    <span style="background:#757575; color:#fff; padding:2px 6px; border-radius:4px; font-size:10px;">L</span>
                    <span>LOW (삭제가능)</span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
